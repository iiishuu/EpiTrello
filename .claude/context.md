# EpiTrello - Project Context

## Important Guidelines

**⚠️ CRITICAL: Never attribute work to AI assistants in commits**
- All commits must appear as if written by the human developer
- Never mention "Claude", "AI", "Generated by", or similar attributions
- Use natural, human-like commit messages
- Maintain consistent authorship with the project owner

## Project Overview

EpiTrello is a Trello-like collaborative task management application built as a full-stack TypeScript project.

### Technology Stack

**Frontend:**
- React 18 with TypeScript
- Vite as build tool
- Redux Toolkit for state management
- TailwindCSS for styling
- Framer Motion for animations
- Axios for HTTP requests
- React Router for navigation

**Backend:**
- Node.js with Express
- TypeScript
- Prisma ORM with PostgreSQL
- JWT authentication
- bcrypt for password hashing

**Infrastructure:**
- Docker & Docker Compose for containerization
- PostgreSQL 15 database
- Development hot-reload enabled

## Architecture

```
EpiTrello/
├── client/           # React frontend
│   ├── src/
│   │   ├── components/   # Reusable UI components
│   │   ├── pages/        # Route pages
│   │   ├── services/     # API services
│   │   ├── store/        # Redux store & slices
│   │   └── types/        # TypeScript types
│   ├── Dockerfile.dev    # Development Docker config
│   └── vite.config.ts    # Vite configuration
├── server/           # Express backend
│   ├── src/
│   │   ├── controllers/  # Route handlers
│   │   ├── middleware/   # Express middleware
│   │   ├── routes/       # API routes
│   │   └── types/        # TypeScript types
│   ├── prisma/          # Database schema & migrations
│   ├── Dockerfile.dev   # Development Docker config
│   └── .env             # Environment variables
└── docker-compose.yml   # Multi-container setup
```

## Key Features Implemented

### Authentication System
- User registration and login
- JWT token-based authentication
- Protected routes with auth middleware
- Automatic token validation and refresh
- Auto-redirect on invalid/expired tokens

### Board Management
- Create, read, update, delete boards
- Board color customization
- Board descriptions
- User-specific boards (ownership)
- Redux state management for boards
- Real-time persistence to backend

### UI/UX
- Responsive layout with sidebar navigation
- Loading states and error handling
- Modal dialogs for board creation
- Page transitions with Framer Motion
- Breadcrumb navigation
- Toast notifications

## Docker Configuration

### Services:
1. **postgres** - PostgreSQL database (port 5432)
2. **server** - Express API (port 5000)
3. **client** - React app (port 5173)

### Key Docker Optimizations:
- Node modules copied from host to avoid network timeouts
- Conditional npm install only if modules missing
- Prisma client generation on build
- Health checks for service dependencies
- Host network binding (0.0.0.0) for container access

## API Endpoints

### Authentication
- `POST /api/auth/register` - User registration
- `POST /api/auth/login` - User login
- `GET /api/auth/me` - Get current user

### Boards
- `GET /api/boards` - List all user boards
- `POST /api/boards` - Create new board
- `GET /api/boards/:id` - Get board details
- `PUT /api/boards/:id` - Update board
- `DELETE /api/boards/:id` - Delete board

## Current Issues Being Tracked

Issues are tracked in the project's issue tracker. Development should proceed sequentially through issues up to **4.1 (inclusive)**.

### General Development Workflow:
1. Read the issue requirements carefully
2. Implement the feature/fix
3. Test thoroughly (manual and/or automated)
4. Commit with descriptive messages
5. Ensure Docker containers run properly
6. Move to next issue

### Testing Checklist per Feature:
- [ ] Backend API endpoints respond correctly
- [ ] Frontend displays data properly
- [ ] Error states handled gracefully
- [ ] Loading states work
- [ ] Docker services remain healthy
- [ ] No TypeScript compilation errors
- [ ] No console errors in browser

## Development Commands

### Local Development:
```bash
# Start PostgreSQL only
docker compose up -d postgres

# Start backend (separate terminal)
cd server && npm run dev

# Start frontend (separate terminal)
cd client && npm run dev
```

### Docker Development:
```bash
# Build and start all services
docker compose up -d --build

# View logs
docker compose logs -f

# Restart specific service
docker compose restart [client|server|postgres]

# Stop all services
docker compose down
```

### Database:
```bash
# Create migration
cd server && npx prisma migrate dev --name migration_name

# Generate Prisma client
npx prisma generate

# Reset database
npx prisma migrate reset
```

## Common Issues & Solutions

### Docker Build Failures
- **Problem**: npm install timeouts
- **Solution**: Node modules are copied from host; ensure local npm install first

### Invalid Token Errors
- **Problem**: Expired/invalid JWT in localStorage
- **Solution**: Interceptors auto-clear and redirect to login

### TypeScript Errors
- **Problem**: Import/export type issues
- **Solution**: Use `import type` for TypeScript-only imports

### Vite Not Accessible in Docker
- **Problem**: Server bound to localhost only
- **Solution**: Configure `server: { host: '0.0.0.0' }` in vite.config.ts

## Code Style Guidelines

### Commits:
- Use conventional commit format: `type: description`
- Types: feat, fix, refactor, docs, style, test, chore
- Keep messages concise but descriptive
- Test before committing

### TypeScript:
- Always define interfaces for API responses
- Use type-only imports where applicable
- Avoid `any` type - use proper typing
- Enable strict mode checks

### React:
- Functional components with hooks only
- Proper error boundaries
- Loading states for async operations
- Cleanup in useEffect when needed

### API:
- Always validate input data
- Return consistent response format
- Use proper HTTP status codes
- Handle errors gracefully

## Environment Variables

### Server (.env):
```
DATABASE_URL="postgresql://user:password@host:5432/database"
JWT_SECRET="your-secret-key"
PORT=5000
NODE_ENV=development
```

### Client:
```
VITE_API_URL=http://localhost:5000/api
```

## Next Steps

Continue implementing features according to the issue tracker, up to and including issue 4.1. Maintain regular commits with clear, human-written messages. Test each feature before moving to the next.
